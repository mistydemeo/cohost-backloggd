<mat-card>
  <form [formGroup]="form">
    <mat-form-field appearance="fill">
      <mat-label>Review URL</mat-label>
      <input matInput [formControl]="form.controls.url" placeholder="https://www.backloggd.com/u/.../review/.../">
    </mat-form-field>

    <mat-slide-toggle [formControl]="form.controls.includeImage">
      Include header image
    </mat-slide-toggle>

    <mat-slide-toggle [formControl]="form.controls.attribution">
      Include link to this generator
    </mat-slide-toggle>
  </form>
</mat-card>

<mat-spinner *ngIf="loading"></mat-spinner>

<div class="result" *ngIf="!loading && (reviewChanges | async); let review">
  <div
      style="display: flex; flex-wrap: wrap; color: #badefc; background-color: #16181c; border-radius: 5px; border: 1px solid #242832; overflow: hidden; box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7)">
      <div
          style="display: flex; flex-wrap: wrap; background-color: #242832; width: 100%; padding-top: 0.75rem; padding-bottom: 0.25rem; z-index: 2">
          <div
              style="margin-bottom: auto; padding-right: 0; flex: 0 0 auto; width: auto; max-width: 100%; position: relative; padding-left: 15px">
              <a href="{{review.reviewerUrl}}">
                  <img src="{{review.reviewerAvatar}}"
                      style="width: 40px; height: 40px; border-radius: 4px; vertical-align: middle; margin: 0">
              </a>
          </div>
          <div
              style="min-width: 0; flex-basis: 0; flex-grow: 1; max-width: 100%; position: relative; width: 100%; padding-right: 15px; padding-left: 15px;">
              <div
                  style="display: flex; flex-wrap: wrap; margin-right: -15px; margin-left: -15px; font-size: .9rem; margin-bottom: 0.25rem;">
                  <div
                      style="min-width: 0; flex-basis: 0; flex-grow: 1; max-width: 100%; position: relative; width: 100%; padding-right: 15px; padding-left: 15px;">
                      <div
                          style="display: flex; flex-wrap: wrap; margin-right: -15px; margin-left: -15px; margin-bottom: 0.25rem">
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; padding-right: 0; margin-bottom: auto; margin-top: auto; margin-right: -0.5rem;">
                              <a href="{{review.reviewerUrl}}"
                                  style="margin-bottom: auto; margin-top: auto; color: #cbd4dc; font-weight: 700; text-decoration: none; display: block">
                                  <p style="font-size: 1.1rem; line-height: normal; margin: 0">{{review.reviewer}}</p>
                              </a>
                          </div>
                          <div *ngIf="review.backer"
                              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; margin-bottom: auto; margin-top: auto; padding-left: 0; padding-right: 0; margin-left: 0.5rem; margin-right: -0.5rem">
                              <p
                                  style="margin: 0 5px; background-color: #ea377a; color: #16181c; font-size: .7rem; border-radius: 4px; font-weight: 600; padding: 0 4px;">
                                  BACKER</p>
                          </div>
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; padding-right: 15px; margin-top: auto">
                              <p style="margin: 0; line-height: normal; font-weight: 200; color: #8f9ca7">reviewed <a
                                      href="{{review.gameUrl}}"
                                      style="color: #cbd4dc; text-decoration: none; font-weight: 600">{{review.game}}</a></p>
                          </div>
                      </div>
                      <div style="display: flex; flex-wrap: wrap; margin-right: -15px; margin-left: -15px;">
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; padding-right: 0; margin-top: auto; margin-bottom: auto;">
                              <div
                                  style="display: flex; flex-wrap: wrap; margin-right: -15px; margin-left: -15px; line-height: normal; margin-left: -2px; font-size: 1.15rem; line-height: 17px; unicode-bidi: bidi-override; color: rgba(146,161,204,.23); height: auto; width: auto; margin: 0 auto; position: relative; padding: 0; white-space: nowrap;">
                                  <div
                                      style="width: {{review.starsPercentage}}; color: #ea377a; padding: 0; position: absolute; z-index: 1; display: block; top: 0; left: 0; height: 100%; overflow: hidden; white-space: nowrap;">
                                      ★★★★★</div>
                                  <div style="padding: 0; display: block; z-index: 0">★★★★★</div>
                              </div>
                          </div>
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 0.5rem; padding-right: 0.25rem; margin-top: auto; margin-bottom: auto; position: relative; margin-left: 0.5rem">
                              <a href="{{review.statusUrl}}"
                                  style="text-decoration: none">
                                  <p style="margin: 0; color: #cbd4dc; padding: 0; line-height: normal; font-weight: 600">{{review.status}}</p>
                                  <div
                                      style="background-color: {{statusColors[review.status]}}; position: absolute; width: 7px; height: 7px; top: 6px; left: -1px; border-radius: 10px;">
                                  </div>
                              </a>
                          </div>
                          <div *ngIf="review.mastered" 
                              style="position: relative; flex: 0 0 auto; width: auto; max-width: 100%; padding-left: 0.25rem; padding-right: 0.25rem">
                              <p style="margin: 0">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3C!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --%3E%3ClinearGradient id='g' y1='0' y2='1' x2='0'%3E%3Cstop offset='0%25' stop-color='%23f975f5'/%3E%3Cstop offset='50%25' stop-color='%238b49b5'/%3E%3Cstop offset='100%25' stop-color='%23604093'/%3E%3C/linearGradient%3E%3Cpath fill='url(%23g)' d='M572.1 82.38C569.5 71.59 559.8 64 548.7 64h-100.8c.2422-12.45 .1078-23.7-.1559-33.02C447.3 13.63 433.2 0 415.8 0H160.2C142.8 0 128.7 13.63 128.2 30.98C127.1 40.3 127.8 51.55 128.1 64H27.26C16.16 64 6.537 71.59 3.912 82.38C3.1 85.78-15.71 167.2 37.07 245.9c37.44 55.82 100.6 95.03 187.5 117.4c18.7 4.805 31.41 22.06 31.41 41.37C256 428.5 236.5 448 212.6 448H208c-26.51 0-47.99 21.49-47.99 48c0 8.836 7.163 16 15.1 16h223.1c8.836 0 15.1-7.164 15.1-16c0-26.51-21.48-48-47.99-48h-4.644c-23.86 0-43.36-19.5-43.36-43.35c0-19.31 12.71-36.57 31.41-41.37c86.96-22.34 150.1-61.55 187.5-117.4C591.7 167.2 572.9 85.78 572.1 82.38zM77.41 219.8C49.47 178.6 47.01 135.7 48.38 112h80.39c5.359 59.62 20.35 131.1 57.67 189.1C137.4 281.6 100.9 254.4 77.41 219.8zM498.6 219.8c-23.44 34.6-59.94 61.75-109 81.22C426.9 243.1 441.9 171.6 447.2 112h80.39C528.1 135.7 526.5 178.7 498.6 219.8z' style='fill: -webkit-linear-gradient(%23f975f5,%238b49b5,%23604093);'/%3E%3C/svg%3E" alt="Mastered" title="Mastered" style="width: 1rem">
                              </p>
                          </div>
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 0; padding-right: 0.25rem; line-height: normal; font-weight: 200; color: #8f9ca7; margin-right: -0.75rem">
                              <p style="margin: 0">on</p>
                          </div>
                          <div
                              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; padding-right: 15px; margin-top: auto; margin-bottom: auto">
                              <a href="{{review.platformUrl}}"
                                  style="margin-top: 0; margin-bottom: 0; margin-left: auto; color: #cbd4dc; line-height: normal; text-decoration: none; font-weight: 600">
                                  <p style="margin: 0">{{review.platform}}</p>
                              </a>
                          </div>
                          <div *ngIf="review.replay"
                              style="position: relative; width: auto; max-width: 100%; padding: 0; margin-top: auto; margin-bottom: auto; line-height: normal; line-weight: 200; color: #8f9ca7">
                            <p style="margin: 0">
                              again
                              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3C!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --%3E%3Cpath d='M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C201.7 512 151.2 495 109.7 466.1C95.2 455.1 91.64 436 101.8 421.5C111.9 407 131.8 403.5 146.3 413.6C177.4 435.3 215.2 448 256 448C362 448 448 362 448 256C448 149.1 362 64 256 64C202.1 64 155 85.46 120.2 120.2L151 151C166.1 166.1 155.4 192 134.1 192H24C10.75 192 0 181.3 0 168V57.94C0 36.56 25.85 25.85 40.97 40.97L74.98 74.98C121.3 28.69 185.3 0 255.1 0L256 0zM256 128C269.3 128 280 138.7 280 152V246.1L344.1 311C354.3 320.4 354.3 335.6 344.1 344.1C335.6 354.3 320.4 354.3 311 344.1L239 272.1C234.5 268.5 232 262.4 232 256V152C232 138.7 242.7 128 256 128V128z' fill='%238f9ca7'/%3E%3C/svg%3E" style="width: 0.9rem">
                            </p>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <div style="width: 100%; height: 0; margin-bottom: 160px" *ngIf="review.image && form.controls.includeImage.value">
          <img style="width: 100%; margin: 0; transform: translateY(-25%)" src="{{review.image}}">
      </div>
      <div style="display: flex; flex-wrap: wrap; margin-top: calc(0.5rem - 160px); z-index: 1; background: linear-gradient(180deg,rgba(125,185,232,0) 0,#16181c calc(160px + 3rem)); padding-top: 160px; width: 100%">
          <div
              style="min-width: 0; flex-basis: 0; flex-grow: 1; max-width: 100%; position: relative; width: 100%; padding-right: 15px; padding-left: 15px;">
              <div style="font-weight: 400; font-size: 0.9rem; margin-bottom: 0">
                  <p style="margin: 0; display: inline-block; word-break: break-word; width: 100%" [innerHtml]="review.body">
                  </p>
              </div>
          </div>
      </div>
      <div style="display: flex; flex-wrap: wrap; width: 100%; background-color: #16181c; z-index: 1; padding-top: 0.5rem; padding-bottom: 1rem">
          <div
              style="position: relative; width: auto; max-width: 100%; padding-left: 15px; padding-right: 15px; margin-left: auto">
              <p style="margin: 0; font-size: .9rem; line-height: normal"><a
                      href="{{review.url}}"
                      style="font-weight: 200; text-decoration: none; color: #8f9ca7">Reviewed on {{review.date}}</a></p>
          </div>
      </div>
  </div>
  <div *ngIf="form.controls.attribution.value" style="text-align: right; font-size: min(1.87vw, 70%); opacity: 0.7"> made with @nex3's <a
          href="https://nex3.github.io/cohost-backloggd">Backloggd formatter</a></div>
</div>
